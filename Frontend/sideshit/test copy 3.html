<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="icon" href="img/core-img/favicon.ico">

    <!-- Core Style CSS -->
    <link rel="stylesheet" href="css/core-style.css">
    <link rel="stylesheet" href="style.css">

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Responsive CSS -->
    <link href="css/responsive.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>

<body>

    <div id="app1">
        <span class="dropdown-product-remove"><i class="icon-cross"></i></span>
        {{cartobj}}
        {{shopitemcount}}
        {{displayprice}}
        {{testcount}}
        <button @click="addcartcount(1)" class="icon-cross"> fuck la chaoi chibai

        </button>

    </div>


    <script type="application/javascript">
        var get_all_URL = "http://localhost:6000/inventory";
        var app = new Vue({
            el: "#app1",
            data: {
                isActive: false,
                shopitemcount: 0,
                displayprice: 0,
                testcount: 0,
                // i assume this is where the dataset of SQL will go 
                // (`item_name`, `artist`, `item_id`, `item_price`, `item_quantity`, `item_category`, `item_status`)
                datalist: [{ "name": "dress", "price": "11", "itemID": 0 },
                { "name": "jeans", "price": "11", "itemID": 1 },
                { "name": "shorts1", "price": "12", "itemID": 2 },
                { "name": "shorts2", "price": "13", "itemID": 3 },
                { "name": "shorts3", "price": "14", "itemID": 4 },
                { "name": "shorts4", "price": "15", "itemID": 5 },
                { "name": "shorts5", "price": "16", "itemID": 6 },

                ],
                // this is the list that will go to the cart
                cartobj: {},
                // just a fix for quantity
                cartlistindex: [],
                realdatalist: {},
            }, mounted() {
                if (localStorage.name) {
                    this.name = localStorage.name;
                }
                if (localStorage.age) {
                    this.age = localStorage.age;
                }
            },
            methods: {
                // backend teste

                getAllBooks: function () {
                    // on Vue instance created, load the book list
                    const response =
                        fetch(get_all_URL)
                            .then(response => response.json())
                            .then(data => {
                                console.log(response);
                                if (data.code === 404) {
                                    // no book in db
                                    this.message = data.message;
                                } else {
                                    this.realdatalist = data.data.books;
                                }
                            })
                            .catch(error => {
                                // Errors when calling the service; such as network error, 
                                // service offline, etc
                                console.log(this.message + error);

                            });

                },

                // frontend functions
                addcartcount: function (itemID) {
                    this.testcount++;
                    cartobj = {}
                    // if index exist in cartlist add to quantity in cart
                    var cartitemID = itemID.toString();
                    if (cartitemID in this.cartobj) {
                        this.cartobj[cartitemID].qty++;
                    } else {

                        for (index in this.datalist) {
                            if (this.datalist[index]["itemID"] == itemID) {
                                cartitemID = itemID.toString();
                                this.cartobj[cartitemID] = this.datalist[index];
                                this.cartobj[cartitemID]["qty"] = 1;
                            }
                        }
                    }

                    todisplayprice = 0;
                    todisplaycount = 0;
                    for (inneritemID in this.cartobj) {
                        todisplayprice += this.cartobj[inneritemID].price
                        todisplaycount += this.cartobj[inneritemID].qty
                    }
                    this.displayprice = todisplayprice;
                    this.shopitemcount = todisplaycount;

                    // delete this item from the cart
                }, deletethis: function (index) {

                }, persist() {
                    localStorage.cart = this.caratobj;

                    console.log('now pretend I did more stuff...');
                }
            }
        })



    </script>

</body>

<!-- jQuery (Necessary for All JavaScript Plugins) -->
<script src="js/jquery/jquery-2.2.4.min.js"></script>
<!-- Popper js -->
<script src="js/popper.min.js"></script>
<!-- Bootstrap js -->
<script src="js/bootstrap.min.js"></script>
<!-- Plugins js -->
<script src="js/plugins.js"></script>
<!-- Active js -->
<script src="js/active.js"></script>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

</html>